(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     22748,        585]
NotebookOptionsPosition[     21753,        548]
NotebookOutlinePosition[     22112,        564]
CellTagsIndexPosition[     22069,        561]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.7025124825735826`*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.702421652037961*^9, 3.702421674799222*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F1", "[", "a_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", "*", "a"}]}], ",", " ", 
      RowBox[{"2", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"a", " ", "-", " ", 
         RowBox[{"a", "^", "2"}]}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"a", " ", "-", " ", 
         RowBox[{"a", "^", "2"}]}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"-", "1"}], " ", "+", " ", 
       RowBox[{"2", "*", "a"}]}]}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"F2", "[", "a_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "*", "a"}], " ", "-", " ", "1"}], ",", " ", 
      RowBox[{"2", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"a", " ", "-", " ", 
         RowBox[{"a", "^", "2"}]}], "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"a", " ", "-", " ", 
         RowBox[{"a", "^", "2"}]}], "]"}]}], ",", " ", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"2", "*", "a"}]}]}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"ph0", "[", "j_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{"k", ",", " ", "j"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "-", " ", "k"}], ")"}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{"r", " ", "-", " ", "j"}], ")"}]}], ")"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{"n", " ", "-", " ", "k"}], ",", " ", 
       RowBox[{"r", " ", "-", " ", "j"}]}], "]"}]}], "]"}], "/", "\n", "   ", 
   
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", " ", "-", " ", "r"}], ")"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{"n", ",", " ", "r"}], "]"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"ph1", "[", "j_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k", " ", "-", " ", "j"}], ")"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{"k", ",", " ", "j"}], "]"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{"n", " ", "-", " ", "k"}], ",", " ", 
       RowBox[{"r", " ", "-", " ", "j"}]}], "]"}]}], "]"}], "/", "\n", "   ", 
   
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", " ", "-", " ", "r"}], ")"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{"n", ",", " ", "r"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Coefficient", " ", "for"}], " ", "|", 
    RowBox[{
     RowBox[{"phi", " ", "j1"}], ">", " ", 
     RowBox[{
     "state", " ", "in", " ", "the", " ", "initial", " ", "state", " ", 
      "v"}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7024277836646757`*^9, 3.7024277932280083`*^9}, {
   3.702427933603161*^9, 3.7024280593304253`*^9}, {3.7024731684816103`*^9, 
   3.702473192680479*^9}, {3.702473281888258*^9, 3.702473281904064*^9}, 
   3.702473539662341*^9, {3.7025130878953648`*^9, 3.70251311134233*^9}, {
   3.702513245457026*^9, 3.7025132624655037`*^9}, {3.702513318600842*^9, 
   3.702513372987094*^9}, {3.702513408511613*^9, 3.7025134085195627`*^9}, {
   3.702513438654539*^9, 3.702513438797298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"#", " ", "of", " ", "Total", " ", "elements"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{"n", "^", 
     RowBox[{"(", 
      RowBox[{"2", "/", "3"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "#", " ", "of", " ", "elements", " ", "in", " ", "a", " ", "S", " ", 
    "set"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "2"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "maximal", " ", "#", " ", "of", " ", "identical", " ", "elements"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.702421597704645*^9, 3.702421644093648*^9}, {
   3.702421679175961*^9, 3.7024217639106197`*^9}, {3.702421799236744*^9, 
   3.702421835331995*^9}, {3.702422074432293*^9, 3.702422076311563*^9}, {
   3.7024221463967*^9, 3.702422172303109*^9}, 3.702422745299835*^9, {
   3.702422970415766*^9, 3.702422970549671*^9}, {3.7024254740835323`*^9, 
   3.70242547496399*^9}, {3.702425562616315*^9, 3.702425563234107*^9}, {
   3.702426746708709*^9, 3.702426747020526*^9}, {3.702427334190875*^9, 
   3.702427334946232*^9}, {3.702427600687001*^9, 3.7024276205968924`*^9}, {
   3.702427676360011*^9, 3.702427676467636*^9}, 3.702427775952303*^9, {
   3.702427817562253*^9, 3.7024278186601667`*^9}, 3.702473545271349*^9, {
   3.702478035619151*^9, 3.702478055692751*^9}, {3.70251418607753*^9, 
   3.702514187357123*^9}, {3.702514809698207*^9, 3.702514810208825*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.702427819024398*^9, 3.702427822578034*^9}, {
   3.702427874401675*^9, 3.70242789081535*^9}, 3.702427924029954*^9, 
   3.7024735457205687`*^9, 3.7024778797902193`*^9, 3.702477948725852*^9, {
   3.702478012392185*^9, 3.702478058528137*^9}, {3.70251341355136*^9, 
   3.702513441435522*^9}, 3.7025139866986217`*^9, {3.702514053378502*^9, 
   3.70251410702516*^9}, {3.702514191010103*^9, 3.702514256536922*^9}, {
   3.702514310895918*^9, 3.7025143444428883`*^9}, 3.702514738603285*^9, 
   3.7025148165694036`*^9, 3.702518075324012*^9, 3.7025182684154882`*^9, 
   3.702558421200048*^9, {3.7025612725825*^9, 3.7025613224578857`*^9}, 
   3.702561397673313*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Unevaluated", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"2", "*", "k"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"IdentityMatrix", "[", "1", "]"}]}]}], "}"}]}], "]"}], "//", 
    "ArrayFlatten"}]}], 
  RowBox[{"(*", 
   RowBox[{"phase", " ", "flip", " ", "for", " ", "answers", " ", "only"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U1", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Unevaluated", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", "[", 
         RowBox[{"k", "/", 
          RowBox[{"(", 
           RowBox[{"n", "-", "r"}], ")"}]}], "]"}], ",", " ", 
        RowBox[{"F1", "[", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"n", "-", "r"}], ")"}]}], "]"}], ",", 
        RowBox[{"IdentityMatrix", "[", "1", "]"}]}], "}"}]}], "]"}], "//", 
    "ArrayFlatten"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"First", " ", "step", " ", "of", " ", "quantum", " ", "walk"}], 
    ",", " ", 
    RowBox[{"map", " ", "from", " ", "H", " ", "to", " ", 
     RowBox[{"H", "'"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U2", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Unevaluated", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "1", "]"}], ",", " ", 
        RowBox[{"F2", "[", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"r", "+", "1"}], ")"}]}], "]"}], ",", " ", 
        RowBox[{"F2", "[", 
         RowBox[{"k", "/", 
          RowBox[{"(", 
           RowBox[{"r", "+", "1"}], ")"}]}], "]"}]}], "}"}]}], "]"}], "//", 
    "ArrayFlatten"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Second", " ", "Step", " ", "of", " ", "quantum", " ", "walk"}], 
    ",", " ", 
    RowBox[{"map", " ", "from", " ", 
     RowBox[{"H", "'"}], " ", "to", " ", "H"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "/", "r"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"k", "/", "2"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "#", " ", "of", " ", "iterations", " ", "for", " ", "phase", " ", "flip"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"t2", "=", 
  RowBox[{
   RowBox[{"IntegerPart", "[", 
    RowBox[{"Pi", "*", 
     RowBox[{
      RowBox[{"Sqrt", "[", "r", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"3", "*", 
        RowBox[{"Sqrt", "[", "k", "]"}]}], ")"}]}]}], "]"}], "+", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "#", " ", "of", " ", "quantum", " ", "walks", " ", "for", " ", "each", " ",
     "phase", " ", "flip"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.702421494476255*^9, 3.702421500404686*^9}, {
   3.702421563659176*^9, 3.702421590055245*^9}, {3.7024217926705093`*^9, 
   3.702421845445444*^9}, 3.702422188933403*^9, 3.702422345691635*^9, {
   3.702422389618648*^9, 3.702422397004364*^9}, 3.702422428063841*^9, 
   3.702422514169138*^9, {3.702422586018507*^9, 3.702422736094652*^9}, {
   3.702424548583685*^9, 3.702424550702917*^9}, {3.702424590472446*^9, 
   3.702424593219954*^9}, {3.702425000386805*^9, 3.702425002049095*^9}, {
   3.702425299884246*^9, 3.702425302091998*^9}, {3.7024277373148518`*^9, 
   3.7024277634355717`*^9}, 3.702428069703188*^9, 3.7024729157888937`*^9, {
   3.702473549715969*^9, 3.702473552327154*^9}, 3.702478026173726*^9, {
   3.7024780629600554`*^9, 3.702478063707148*^9}, {3.702513381055385*^9, 
   3.7025133821892138`*^9}, {3.702513427270885*^9, 3.7025134317903547`*^9}, 
   3.702513659801898*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.70247291799314*^9, 3.7024735540602903`*^9, 3.702477948772621*^9, {
   3.7024780124435043`*^9, 3.7024780394008703`*^9}, {3.7025134170803003`*^9, 
   3.702513442730673*^9}, 3.7025136602564363`*^9, 3.70251398672806*^9, {
   3.7025140534019747`*^9, 3.702514107058793*^9}, {3.702514191032889*^9, 
   3.702514256564727*^9}, {3.702514310920362*^9, 3.702514344476357*^9}, 
   3.702514738624408*^9, {3.702514816594758*^9, 3.702514821722584*^9}, 
   3.702518075355089*^9, 3.702518268448443*^9, 3.702558421222937*^9, {
   3.7025612726147137`*^9, 3.702561322480565*^9}, 3.7025613976912746`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.70247291799314*^9, 3.7024735540602903`*^9, 3.702477948772621*^9, {
   3.7024780124435043`*^9, 3.7024780394008703`*^9}, {3.7025134170803003`*^9, 
   3.702513442730673*^9}, 3.7025136602564363`*^9, 3.70251398672806*^9, {
   3.7025140534019747`*^9, 3.702514107058793*^9}, {3.702514191032889*^9, 
   3.702514256564727*^9}, {3.702514310920362*^9, 3.702514344476357*^9}, 
   3.702514738624408*^9, {3.702514816594758*^9, 3.702514821722584*^9}, 
   3.702518075355089*^9, 3.702518268448443*^9, 3.702558421222937*^9, {
   3.7025612726147137`*^9, 3.702561322480565*^9}, 3.702561397697907*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "3"]}], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"]}], "3"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"]}], "3"], ",", 
     FractionBox["1", "3"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "3"], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"]}], "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"]}], "3"], ",", 
     RowBox[{"-", 
      FractionBox["1", "3"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.70247291799314*^9, 3.7024735540602903`*^9, 3.702477948772621*^9, {
   3.7024780124435043`*^9, 3.7024780394008703`*^9}, {3.7025134170803003`*^9, 
   3.702513442730673*^9}, 3.7025136602564363`*^9, 3.70251398672806*^9, {
   3.7025140534019747`*^9, 3.702514107058793*^9}, {3.702514191032889*^9, 
   3.702514256564727*^9}, {3.702514310920362*^9, 3.702514344476357*^9}, 
   3.702514738624408*^9, {3.702514816594758*^9, 3.702514821722584*^9}, 
   3.702518075355089*^9, 3.702518268448443*^9, 3.702558421222937*^9, {
   3.7025612726147137`*^9, 3.702561322480565*^9}, 3.70256139770313*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.70247291799314*^9, 3.7024735540602903`*^9, 3.702477948772621*^9, {
   3.7024780124435043`*^9, 3.7024780394008703`*^9}, {3.7025134170803003`*^9, 
   3.702513442730673*^9}, 3.7025136602564363`*^9, 3.70251398672806*^9, {
   3.7025140534019747`*^9, 3.702514107058793*^9}, {3.702514191032889*^9, 
   3.702514256564727*^9}, {3.702514310920362*^9, 3.702514344476357*^9}, 
   3.702514738624408*^9, {3.702514816594758*^9, 3.702514821722584*^9}, 
   3.702518075355089*^9, 3.702518268448443*^9, 3.702558421222937*^9, {
   3.7025612726147137`*^9, 3.702561322480565*^9}, 3.702561397708518*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.70247291799314*^9, 3.7024735540602903`*^9, 3.702477948772621*^9, {
   3.7024780124435043`*^9, 3.7024780394008703`*^9}, {3.7025134170803003`*^9, 
   3.702513442730673*^9}, 3.7025136602564363`*^9, 3.70251398672806*^9, {
   3.7025140534019747`*^9, 3.702514107058793*^9}, {3.702514191032889*^9, 
   3.702514256564727*^9}, {3.702514310920362*^9, 3.702514344476357*^9}, 
   3.702514738624408*^9, {3.702514816594758*^9, 3.702514821722584*^9}, 
   3.702518075355089*^9, 3.702518268448443*^9, 3.702558421222937*^9, {
   3.7025612726147137`*^9, 3.702561322480565*^9}, 3.702561397713398*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ph0", "[", "0", "]"}], ",", " ", 
     RowBox[{"ph1", "[", "0", "]"}], ",", 
     RowBox[{"ph0", "[", "1", "]"}], ",", 
     RowBox[{"ph1", "[", "1", "]"}], ",", " ", 
     RowBox[{"ph0", "[", "2", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"v", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0.5", ",", "0.5", ",", "0.5", ",", " ", "0.5"}], 
     "}"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Simplify", "[", 
    RowBox[{"U2", ".", "v"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"|", 
     RowBox[{"phi_start", ">", " ", 
      RowBox[{"in", " ", "the", " ", "paper"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "which", " ", "is", " ", "a", " ", "uniform", " ", "superposition", " ", 
      "of"}], " ", "|", 
     RowBox[{
      RowBox[{"S", " ", "y"}], ">", 
      RowBox[{"'", "s", " ", "transformed", " ", "to"}]}], " ", "|", 
     RowBox[{
      RowBox[{"phi", " ", "jl"}], ">", " ", "basis"}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7024222979723797`*^9, 3.702422313963784*^9}, {
   3.70242423926081*^9, 3.7024242927278767`*^9}, {3.702424452880389*^9, 
   3.702424489254915*^9}, {3.702425482147344*^9, 3.7024254944276247`*^9}, {
   3.702425833411729*^9, 3.70242587642244*^9}, {3.702426328543198*^9, 
   3.702426337367188*^9}, {3.702427395693165*^9, 3.702427433137014*^9}, {
   3.702427537367032*^9, 3.702427584105659*^9}, 3.7024277158623943`*^9, {
   3.702428074156996*^9, 3.702428127553212*^9}, {3.7024729913802032`*^9, 
   3.7024730044181633`*^9}, {3.7024734478176403`*^9, 3.7024734482250557`*^9}, 
   3.702477904580019*^9, {3.702513749306938*^9, 3.7025137694405737`*^9}, {
   3.702513946450224*^9, 3.702513951599221*^9}, {3.702514006148755*^9, 
   3.702514050412883*^9}, {3.702514095205083*^9, 3.702514104476541*^9}, {
   3.702518257385832*^9, 3.702518264233304*^9}, {3.70255841034772*^9, 
   3.702558418655396*^9}, {3.702561313801955*^9, 3.702561319816862*^9}, {
   3.7025613670413437`*^9, 3.702561374655582*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["1", 
    SqrtBox["6"]], ",", 
   FractionBox["1", 
    SqrtBox["3"]], ",", 
   FractionBox["1", 
    SqrtBox["3"]], ",", 
   FractionBox["1", 
    SqrtBox["6"]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702477905407942*^9, 3.702477948864233*^9, {3.7024780125531607`*^9, 
   3.702478039491143*^9}, 3.70251345518386*^9, 3.702513665968917*^9, {
   3.70251375244355*^9, 3.702513769662353*^9}, 3.702513986778934*^9, {
   3.7025140534542217`*^9, 3.7025141071094427`*^9}, {3.702514191091422*^9, 
   3.7025142566109037`*^9}, {3.702514310973171*^9, 3.702514344527398*^9}, 
   3.7025147386798277`*^9, 3.702514816643387*^9, 3.702518075405838*^9, 
   3.702518268511675*^9, 3.7025584212810183`*^9, {3.702561272666293*^9, 
   3.702561322530547*^9}, {3.702561377882627*^9, 3.7025613977523527`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"U2", ".", "U1"}], ",", "t2"}], "]"}], ",", "t1"}], "]"}], 
     ".", "v"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.702422764983357*^9, 3.7024228320294123`*^9}, {
   3.702422915451461*^9, 3.702422943347313*^9}, {3.702425353941544*^9, 
   3.702425369074954*^9}, {3.702425405841536*^9, 3.702425421627195*^9}, 
   3.70242770908541*^9, {3.702514067670309*^9, 3.702514087924923*^9}, {
   3.702514198125742*^9, 3.702514226827908*^9}, {3.702514304131239*^9, 
   3.702514342113193*^9}, {3.702514719453155*^9, 3.702514720213048*^9}, {
   3.702518068578657*^9, 3.702518068834553*^9}, {3.702561265437797*^9, 
   3.7025613329529*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Prob", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "]"}], ",", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "]"}], ",", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "]"}], ",", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "^", "2"}], "]"}], ",", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "5", "]"}], "]"}], "^", "2"}], "]"}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.702422797124802*^9, 3.702422799842287*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.16666666666666666`", ",", "0.3333333333333333`", ",", 
   "0.3333333333333333`", ",", "0.16666666666666666`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.702422456870378*^9, 3.702422800795999*^9, 3.702422835443397*^9, 
   3.7024229569070463`*^9, 3.702423003360608*^9, {3.702424288233985*^9, 
   3.702424298935177*^9}, 3.7024244946705093`*^9, {3.7024245431345053`*^9, 
   3.702424558689596*^9}, 3.702424602519898*^9, 3.702425017929016*^9, {
   3.7024253242188263`*^9, 3.702425379807762*^9}, {3.7024254109000063`*^9, 
   3.70242542740615*^9}, 3.702425497775979*^9, {3.702425869850452*^9, 
   3.702425880873337*^9}, {3.7024263412915583`*^9, 3.702426358567568*^9}, {
   3.702427575644925*^9, 3.702427623921199*^9}, 3.702427703772973*^9, 
   3.7024278242884417`*^9, {3.7024278750487967`*^9, 3.7024278909713993`*^9}, 
   3.7024279241147337`*^9, 3.702477891570715*^9, 3.702477948946103*^9, {
   3.7024780126340923`*^9, 3.7024780396184464`*^9}, 3.7025134633636847`*^9, 
   3.702513986815021*^9, {3.7025140534909286`*^9, 3.7025141071456327`*^9}, {
   3.702514191276349*^9, 3.7025142102151747`*^9}, {3.702514256461568*^9, 
   3.702514282868163*^9}, {3.70251433666158*^9, 3.702514346171713*^9}, {
   3.702514728043867*^9, 3.702514738716592*^9}, 3.702514816680369*^9, 
   3.7025180754561567`*^9, 3.702518268556056*^9, 3.702558421325713*^9, {
   3.702561272704916*^9, 3.702561322569462*^9}, {3.702561362374946*^9, 
   3.702561397789814*^9}}]
}, Open  ]]
},
WindowSize->{808, 606},
WindowMargins->{{58, Automatic}, {Automatic, 60}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 71, 1, 32, "Input"],
Cell[632, 23, 139, 2, 32, "Input"],
Cell[774, 27, 3525, 101, 160, "Input"],
Cell[CellGroupData[{
Cell[4324, 132, 1590, 34, 138, "Input"],
Cell[5917, 168, 703, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6657, 183, 3826, 102, 222, "Input"],
Cell[10486, 287, 1126, 22, 32, "Output"],
Cell[11615, 311, 1127, 23, 32, "Output"],
Cell[12745, 336, 1514, 39, 88, "Output"],
Cell[14262, 377, 633, 9, 32, "Output"],
Cell[14898, 388, 633, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15568, 402, 2152, 47, 118, "Input"],
Cell[17723, 451, 852, 19, 48, "Output"]
}, Open  ]],
Cell[18590, 473, 837, 18, 32, "Input"],
Cell[CellGroupData[{
Cell[19452, 495, 797, 25, 32, "Input"],
Cell[20252, 522, 1485, 23, 66, "Output"]
}, Open  ]]
}
]
*)

